<template>
    <!-- 用户个人中心首页 -->
    <div class="user-center">
        <div class="uc-head">
            <img :src="userinfo.avatar" />
            <h2>{{userinfo.nickname}}</h2>
        </div>
        <div class="uc-center">
            <ul class="uc-center-ul">
                <li @click="goPage('merchant')">
                    <svg t="1560132625792" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1669" xmlns:xlink="http://www.w3.org/1999/xlink" width="64" height="64"><defs><style type="text/css"></style></defs><path d="M752.128 455.68v434.176h-48.128V262.656h96.256L510.976 70.144 221.696 262.656h96.256v627.2h-48.128V455.68H77.312v482.304h868.352V455.68h-193.536zM125.44 552.448h96.256v48.128H125.44v-48.128z m0 96.256h96.256v48.128H125.44v-48.128z m0 96.768h96.256v48.128H125.44v-48.128z m385.536-434.176c53.248 0 96.256 43.008 96.256 96.256s-43.008 96.256-96.256 96.256S414.72 460.8 414.72 407.552s43.008-96.256 96.256-96.256zM414.72 889.856v-241.152h193.024v241.152H414.72z m386.048-337.408h96.256v48.128h-96.256v-48.128z m0 96.256h96.256v48.128h-96.256v-48.128z m0 96.768h96.256v48.128h-96.256v-48.128z m0 0" p-id="1670" fill="#2cbe4e"></path></svg>
                    <span>学校设置</span>
                </li>
                <li @click="goPage('subject')">
                    <svg t="1560132704685" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3574" xmlns:xlink="http://www.w3.org/1999/xlink" width="64" height="64"><defs><style type="text/css"></style></defs><path d="M889.6 140.8H134.4c-38.4 0-70.4 32-70.4 76.8v595.2c0 38.4 32 70.4 70.4 70.4h755.2c38.4 0 70.4-32 70.4-70.4V217.6c0-44.8-32-76.8-70.4-76.8z m0 268.8V512h-198.4V409.6h198.4zM204.8 262.4h198.4v102.4H204.8V262.4z m198.4 147.2V512H204.8V409.6h198.4zM204.8 556.8h198.4v102.4H204.8V556.8z m198.4 249.6H204.8V704h198.4v102.4zM448 262.4h198.4v102.4H448V262.4z m198.4 147.2V512H448V409.6h198.4zM448 556.8h198.4v102.4H448V556.8z m204.8 249.6H454.4V704h198.4v102.4z m38.4-544h198.4v102.4h-198.4V262.4z m0 294.4h198.4v102.4h-198.4V556.8z m198.4 249.6h-198.4V704h198.4v102.4z" p-id="3575" fill="#2cbe4e"></path></svg>
                    <span>课程设置</span>
                </li>
                <li @click="goPage('myappointment')">
                    <svg t="1560136121848" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4426" xmlns:xlink="http://www.w3.org/1999/xlink" width="64" height="64"><defs><style type="text/css"></style></defs><path d="M876.088889 187.733333h-164.977778V119.466667c0-5.688889-5.688889-5.688889-5.688889-5.688889h-56.888889c-5.688889 0-5.688889 5.688889-5.688889 5.688889v62.577777H386.844444V119.466667S381.155556 113.777778 375.466667 113.777778h-56.888889l-5.688889 5.688889v62.577777H147.911111c-17.066667 5.688889-34.133333 17.066667-34.133333 34.133334v659.911111c0 17.066667 17.066667 34.133333 34.133333 34.133333h733.866667c17.066667 0 34.133333-17.066667 34.133333-34.133333V216.177778c-5.688889-17.066667-22.755556-28.444444-39.822222-28.444445z m-34.133333 654.222223H182.044444V244.622222h130.844445v51.2c0 5.688889 5.688889 5.688889 5.688889 5.688889h56.888889c5.688889 0 5.688889-5.688889 5.688889-5.688889v-51.2h261.688888v51.2c0 5.688889 5.688889 5.688889 5.688889 5.688889h56.888889c5.688889 0 5.688889-5.688889 5.688889-5.688889v-51.2h130.844445v597.333334z m-142.222223-398.222223h-56.888889c-5.688889 0-11.377778 0-11.377777 5.688889l-164.977778 221.866667L398.222222 574.577778c-5.688889-5.688889-5.688889-5.688889-11.377778-5.688889h-56.888888c-5.688889 0-11.377778 5.688889-5.688889 11.377778l136.533333 187.733333c5.688889 11.377778 22.755556 11.377778 28.444444 0l227.555556-312.888889c-5.688889 0-5.688889-11.377778-17.066667-11.377778z" p-id="4427" fill="#2cbe4e"></path></svg>
                    <span>预约记录</span>
                </li>
            </ul>
            <ul class="uc-center-ul">
                <li @click="goPage('reply')">
                    <svg t="1561011820036" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2043" data-spm-anchor-id="a313x.7781069.0.i7" xmlns:xlink="http://www.w3.org/1999/xlink" width="64" height="64"><defs><style type="text/css"></style></defs><path d="M346.624 530.432c0-12.288-9.728-22.528-22.016-22.528-79.872 0-144.384-70.144-144.384-156.672C180.224 264.704 244.736 194.56 324.608 194.56c12.288 0 22.016-10.24 22.016-22.528 0-12.288-9.728-22.528-22.016-22.528-103.936 0-188.416 90.112-188.416 201.216 0 73.728 37.376 138.24 93.184 173.568C111.104 567.296 25.6 687.616 25.6 828.416c0 12.288 9.728 22.528 22.016 22.528s22.016-10.24 22.016-22.528c0-152.064 114.688-275.968 255.488-275.968 11.776 0 21.504-9.728 21.504-22.016z" fill="#666666" p-id="2044"></path><path d="M808.448 335.872c0-128.512-102.912-233.472-229.888-233.472-126.464 0-229.888 104.96-229.888 233.472 0 89.088 49.152 166.4 121.344 205.824-150.528 47.104-260.096 189.44-260.096 357.888 0 12.288 9.728 22.528 22.016 22.528s22.016-10.24 22.016-22.528c0-181.76 145.408-329.216 322.56-329.728 2.048 0 4.608 0 6.656-0.512 125.44-3.072 225.28-107.008 225.28-233.472zM578.56 524.8c-102.4 0-185.856-84.992-185.856-188.928S476.16 146.944 578.56 146.944s185.856 84.992 185.856 188.928c0 103.936-83.456 188.928-185.856 188.928zM972.8 716.8h-128v-128c0-13.824-11.264-25.6-25.6-25.6-13.824 0-25.6 11.776-25.6 25.6v128h-128c-13.824 0-25.6 11.264-25.6 25.6 0 13.824 11.776 25.6 25.6 25.6h128v128c0 13.824 11.264 25.6 25.6 25.6 13.824 0 25.6-11.776 25.6-25.6v-128h128c13.824 0 25.6-11.264 25.6-25.6 0-13.824-11.776-25.6-25.6-25.6z" fill="#2cbe4e" p-id="2045" data-spm-anchor-id="a313x.7781069.0.i5" class="selected"></path></svg>
                    <span>报名管理</span>
                </li>
                <li @click="goPage('activity')">
                    <svg t="1561618061830" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2438" data-spm-anchor-id="a313x.7781069.0.i4" width="64" height="64"><path d="M223.530667 633.450667l73.578666 19.712c6.762667 1.813333 13.738667 2.752 20.693334 2.752 35.413333 0 66.624-23.530667 75.904-57.216l66.474666-240.661334a76.16 76.16 0 0 0-7.637333-58.88 77.909333 77.909333 0 0 0-47.637333-36.288l-73.557334-19.712a79.893333 79.893333 0 0 0-20.693333-2.730666c-35.434667 0-66.645333 23.530667-75.904 57.216L168.277333 538.325333a76.202667 76.202667 0 0 0 7.616 58.858667 77.738667 77.738667 0 0 0 47.637334 36.266667z m52.309333-324.437334c4.16-15.125333 18.453333-25.898667 34.773333-25.898666 3.264 0 6.506667 0.426667 9.621334 1.258666l73.578666 19.733334c9.429333 2.517333 17.045333 8.32 21.781334 16.490666 4.714667 8.085333 5.888 17.194667 3.413333 26.112l-9.941333 35.989334-143.253334-37.312 10.026667-36.373334zM209.408 549.674667l45.056-163.178667 143.274667 37.312-45.162667 163.52c-4.16 15.125333-18.474667 25.898667-34.773333 25.898667-3.2 0-6.442667-0.426667-9.621334-1.28l-73.642666-19.733334a35.413333 35.413333 0 0 1-21.781334-16.490666 33.344 33.344 0 0 1-3.349333-26.048z" fill="#2cbe4e" p-id="2439" data-spm-anchor-id="a313x.7781069.0.i7" class="selected"></path><path d="M810.218667 381.44a57.386667 57.386667 0 0 0-57.194667 50.752c-0.362667 0.021333-0.213333 1.216 0.32 3.221333l-22.186667 8.106667c-23.146667 8.448-46.464 16.874667-68.416 24.746667l-3.754666 1.344c-45.973333 16.469333-79.253333 28.010667-93.632 32.362666-34.56 10.410667-51.221333-1.514667-41.962667-45.290666a948.906667 948.906667 0 0 1 14.698667-58.176 2550.784 2550.784 0 0 1 24.106666-79.936c2.133333-6.72 4.138667-12.864 5.909334-18.325334l1.792-5.461333a128 128 0 1 0-40.277334-14.037333l-2.048 6.250666a2634.24 2634.24 0 0 0-30.549333 100.010667 992.725333 992.725333 0 0 0-15.36 60.864c-16.597333 78.549333 32.874667 114.005333 96.021333 94.976 15.381333-4.629333 48.938667-16.277333 95.701334-33.045333l3.776-1.344c22.037333-7.893333 45.397333-16.362667 68.608-24.832l22.4-8.170667 0.917333-0.341333c2.304 4.693333 4.096 7.637333 4.693333 7.146666 3.541333 2.858667 7.36 5.333333 11.498667 7.296l-21.248 482.112a19.050667 19.050667 0 0 0 18.368 19.733334c11.093333 0.021333 19.584-7.936 20.010667-18.090667l21.141333-479.658667c25.429333-5.952 44.458667-28.416 44.458667-55.253333-0.021333-31.424-25.941333-56.96-57.792-56.96zM505.984 168.533333a85.333333 85.333333 0 1 1 170.666667 0 85.333333 85.333333 0 0 1-170.666667 0z m304.234667 288.917334c-10.709333 0-19.413333-8.554667-19.413334-19.072s8.704-19.093333 19.413334-19.093334c10.688 0 19.370667 8.576 19.370666 19.093334s-8.704 19.072-19.370666 19.072z" fill="#2cbe4e" p-id="2440" data-spm-anchor-id="a313x.7781069.0.i5" class="selected"></path><path d="M472.213333 570.218667c-31.04 8.682667-39.872 32.213333-50.517333 95.232l-2.730667 16.170666c-1.045333 6.165333-1.962667 11.264-2.901333 16.149334-5.653333 29.568-12.053333 49.941333-21.418667 65.194666-8.448 13.738667-28.096 32.810667-56.341333 54.954667-12.970667 10.176-27.52 20.821333-43.370667 31.850667a1631.424 1631.424 0 0 1-76.288 49.621333 1705.237333 1705.237333 0 0 1-34.602666 20.672 21.354667 21.354667 0 0 0 21.205333 37.034667 2050.88 2050.88 0 0 0 35.690667-21.312 1659.733333 1659.733333 0 0 0 78.314666-50.944 975.168 975.168 0 0 0 45.376-33.322667c31.957333-25.066667 54.549333-46.997333 66.346667-66.176 12.714667-20.672 20.458667-45.290667 26.986667-79.530667 0.981333-5.184 1.941333-10.538667 3.050666-16.938666 0.64-3.712 2.752-16.384 2.752-16.256 7.296-43.242667 13.376-59.413333 19.946667-61.248 7.168-2.005333 32.106667 17.834667 58.432 53.44 27.434667 37.12 51.562667 83.498667 59.818667 114.816 4.352 16.512 6.72 37.568 7.274666 61.952a667.946667 667.946667 0 0 1-3.818666 82.538666 736.938667 736.938667 0 0 1-3.904 31.338667 21.333333 21.333333 0 1 0 42.154666 6.656 823.893333 823.893333 0 0 0 4.202667-33.621333c3.050667-29.674667 4.650667-59.669333 4.032-87.872-0.618667-27.456-3.349333-51.626667-8.661333-71.850667-23.530667-89.344-115.712-214.016-171.029334-198.549333z" fill="#2cbe4e" p-id="2441" data-spm-anchor-id="a313x.7781069.0.i6" class="selected"></path></svg>
                    <span>我的活动</span>
                </li>
                <li @click="goPage('article')">
                    <svg t="1561618510100" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3759" width="64" height="64"><path d="M319.645538 689.230769c-3.938462 0-11.815385-3.938462-15.753846-3.938461L173.922462 551.384615c-7.876923-7.876923-7.876923-19.692308 0-27.56923L693.799385 7.876923c3.938462-3.938462 7.876923-7.876923 11.815384-7.876923 3.938462 0 11.815385 3.938462 15.753846 3.938462l129.969231 129.96923c7.876923 7.876923 7.876923 19.692308 0 27.569231L331.460923 681.353846c0 3.938462-7.876923 7.876923-11.815385 7.876923zM59.707077 807.384615c-3.938462 0-11.815385-3.938462-15.753846-3.938461-3.938462-3.938462-7.876923-11.815385-3.938462-19.692308l39.384616-169.353846c0-7.876923 7.876923-11.815385 15.753846-15.753846s15.753846 0 19.692307 3.938461l133.907693 129.969231c0 7.876923 3.938462 15.753846 0 23.630769-3.938462 7.876923-7.876923 11.815385-15.753846 15.753847l-169.353847 39.384615c0-3.938462 0-3.938462-3.938461-3.938462zM910.414769 1024h-827.076923c-31.507692 0-59.076923-27.569231-59.076923-59.076923S51.830154 905.846154 83.337846 905.846154h827.076923c31.507692 0 59.076923 27.569231 59.076923 59.076923s-27.569231 59.076923-59.076923 59.076923z" fill="#2cbe4e" p-id="3760" data-spm-anchor-id="a313x.7781069.0.i17" class="selected"></path></svg>
                    <span>页面编辑</span>
                </li>
            </ul>
        </div>

    </div>

</template>

<script>
    import {getCookie, setCookie} from "~/assets/utils/util";
    import {wechat_authorize_userinfo} from "~/assets/utils/wechat";
    import {accessToken, token} from "~/assets/services/user";

    export default {
        name: "users",
        data(){
            return {
                userinfo:{}
            }
        },
        methods:{
            // 页面初始化，请求用户授权或拉取数据
            async pageInit(){
                let localToken = getCookie("token")
                let code = this.$route.query.code
                let state = this.$route.query.state
                if(!localToken){
                    if (!code) {
                        wechat_authorize_userinfo(window.location.href)
                    }
                    if (code) {
                        let res = await accessToken({
                            code: code,
                            state: state
                        });
                        this.userinfo = JSON.parse(res.data.user)
                        if(res.data.openid){
                            setCookie('token', res.data.openid, 7)
                            this.$store.commit('setOpenid',res.data.openid)
                        }
                    }
                }else{
                    let res = await token()
                    this.userinfo = JSON.parse(res.data)
                }
                if(this.userinfo.merchant !== 1){
                    this.$toast("您还没有入驻，请先成为商家再来吧")
                    setTimeout(()=>{
                        this.$router.push({name:'user'})
                    },2000)
                }
            },
            goPage(type){
                this.$router.push({name:'business-'+type})
            }
        },
        mounted() {
            this.pageInit()
            console.log(this.$route.params.aid)
        },
        components:{

        }
    }
</script>

<style scoped>
    .uc-head{
        height:160px;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding-top:30px;
    }
    .uc-head img{
        height:90px;
        width:90px;
        border-radius:50%;
    }
    .uc-head h2{
        font-weight: 800;
        font-size: 20px;
    }
    .uc-center-ul{
        display: flex;
        flex-wrap: wrap;
        width:100%;
        background-color: white;
        justify-content: space-around;
        padding: 10px;
    }
    .uc-center-ul li{
        display: inline-flex;
        flex-direction: column;
        align-items: center;
    }
    .uc-center-ul li svg{
        height:64px;
        width:64px;
    }
</style>